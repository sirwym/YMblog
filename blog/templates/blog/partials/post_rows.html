{% for post in posts %}
    <article class="group py-8 border-b border-base-content/10 last:border-none transition-all duration-300 hover:bg-base-200/30 -mx-4 px-4 rounded-xl">
        <div class="flex items-center gap-3 text-xs text-base-content/60 mb-2 font-mono">
            <time datetime="{{ post.published_at|date:'Y-m-d' }}">
                {{ post.published_at|date:"Y-m-d" }}
            </time>

            {% if post.category %}
                <span>/</span>
                <a href="?category={{ post.category.slug }}" class="hover:text-primary transition-colors">
                    {{ post.category.name }}
                </a>
            {% endif %}
        </div>

        <div class="flex justify-between items-start gap-4">
            <div class="w-full">
                <h2 class="text-2xl font-bold mb-3 leading-tight flex items-center gap-2">
                    <a href="{% url 'blog:post_detail' post.slug %}" class="group-hover:text-primary transition-colors">
                        {{ post.title }}
                    </a>

                    {% if post.is_encrypted %}
                        <span class="tooltip" data-tip="需要密码">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-warning/80" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z" clip-rule="evenodd" />
                            </svg>
                        </span>
                    {% endif %}
                </h2>

                <p class="text-base-content/70 text-base leading-relaxed line-clamp-3 mb-4">
                    {{ post.excerpt|default:"暂无摘要，点击标题阅读全文..." }}
                </p>

                <div class="flex flex-wrap items-center justify-between gap-4 mt-2">

                    <div class="flex flex-wrap gap-2">
                        {% for tag in post.tags.all|slice:":3" %}
                            <a href="?tag={{ tag.slug }}" class="text-xs font-mono text-primary/80 bg-primary/5 px-2 py-1 rounded hover:bg-primary/10 transition-colors">
                                #{{ tag.name }}
                            </a>
                        {% endfor %}
                    </div>

                    <a href="{% url 'blog:post_detail' post.slug %}" class="flex items-center gap-1 text-sm font-medium text-base-content/60 group-hover:text-primary transition-colors group-hover:translate-x-1 duration-300">
                        阅读全文
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>
                    </a>
                </div>
            </div>
        </div>
    </article>
{% endfor %}

{% if posts.has_next %}
    <div hx-get="?page={{ posts.next_page_number }}"
         hx-trigger="revealed"
         hx-swap="outerHTML"
         class="py-12 text-center w-full">
        <span class="loading loading-dots loading-lg text-primary/50"></span>
    </div>
{% endif %}
